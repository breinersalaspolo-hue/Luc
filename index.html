<!doctype html>

<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Animación — Lucas el más lindo → Logo Bleesd</title>
  <style>
    :root{
      --bg1:#060a18;
      --bg2:#0b1024;
      --ink:#eaf6ff;
      --blue:#4cc7ff;
      --blue2:#2ea0ff;
      --glow:#6bd7ff;
      --accent:#9ad7ff;
    }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0}
    body{font-family:system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial; color:var(--ink); background:radial-gradient(1200px 600px at 50% 110%, #0d1430 0%, #060a18 55%, #030711 100%); overflow:hidden}/* Stage */
.stage{position:relative;width:100vw;height:100vh;}

/* Tap gate (for mobile audio policies) */
.gate{position:absolute;inset:0;display:grid;place-items:center;background:linear-gradient(180deg,rgba(0,0,0,.55),rgba(0,0,0,.35));z-index:50}
.gate button{padding:14px 22px;border:none;border-radius:16px;background:#111827;color:#fff;font-weight:700;font-size:16px;box-shadow:0 8px 24px rgba(0,0,0,.35);cursor:pointer}

/* Characters */
.char{position:absolute;bottom:6%;width:150px;height:150px;border-radius:18px;display:flex;align-items:end;justify-content:center;padding:8px;box-shadow:0 16px 40px rgba(0,0,0,.55);background:rgba(255,255,255,.03);backdrop-filter:blur(2px)}
.char img{max-width:100%;max-height:100%;border-radius:14px;display:block}
.left{left:3%}
.right{right:3%}

/* Elegant headline font */
@font-face{
  font-family:"Elegante";
  src: local("Segoe UI"), local("Helvetica Neue");
}
.letter{position:absolute;font-family:Elegante, "Segoe UI", system-ui; font-weight:800; font-size: clamp(26px,5vw,64px); letter-spacing:1px; opacity:0; transform:translate(-50%,-50%) scale(.7); filter:drop-shadow(0 4px 10px rgba(0,0,0,.45)); transition:opacity .35s ease, transform .45s cubic-bezier(.2,.9,.2,1)}
.letter.show{opacity:1;transform:translate(-50%,-50%) scale(1)}

/* Blue flame projectile */
.flame{position:absolute; width:20px;height:20px; pointer-events:none; filter:drop-shadow(0 0 6px var(--glow)) drop-shadow(0 0 14px rgba(103,214,255,.6));}
.flame .core{position:absolute;inset:0;border-radius:50%;background:radial-gradient(circle at 50% 60%, #d8f7ff 0%, var(--blue) 35%, var(--blue2) 70%, rgba(0,0,0,0) 72%)}
.flame .tail{position:absolute;left:50%;top:50%;width:10px;height:10px;border-radius:50%;background:radial-gradient(circle, rgba(108,217,255,.9), rgba(46,160,255,.15)); transform:translate(-50%,-50%); animation:tail 600ms linear infinite}
@keyframes tail{from{transform:translate(-50%,-50%) scale(.9)} to{transform:translate(-50%,-50%) scale(.2); opacity:0}}

/* Tile reveal for final logo */
.logoGrid{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%); display:grid; gap:2px; opacity:0}
.tile{width:40px;height:40px;background-size:100% 100%;background-repeat:no-repeat;opacity:0;transform:scale(.7);box-shadow:0 0 0 0 rgba(0,0,0,0); transition:opacity .5s ease, transform .5s ease, box-shadow .5s ease}
.tile.show{opacity:1;transform:scale(1);box-shadow:0 6px 18px rgba(0,0,0,.35)}

.caption{position:absolute;left:50%;bottom:4%;transform:translateX(-50%);font-size:13px;color:rgba(255,255,255,.6)}

@media (max-width:680px){
  .char{width:110px;height:110px}
  .tile{width:28px;height:28px}
}

  </style>
</head>
<body>
  <div class="stage" id="stage">
    <div class="gate" id="gate"><button id="startBtn">Toca para iniciar</button></div><div class="char left" id="leftChar">
  <!-- Reemplaza left.png por el personaje 1 (Bajoterra) -->
  <img src="left.png" alt="Personaje izquierda" />
</div>
<div class="char right" id="rightChar">
  <!-- Reemplaza right.png por el personaje 2 (Bajoterra) -->
  <img src="right.png" alt="Personaje derecha" />
</div>

<div id="lettersContainer"></div>
<div id="logoGrid" class="logoGrid"></div>

<!-- Audio: coloca el archivo mp3 con la voz romántico/urbana -->
<audio id="voice" src="voz_romantico_urbano.mp3" preload="auto"></audio>

<div class="caption">Click/Tap para repetir • Personajes lanzan llamas → “Lucas el más lindo” → Logo (armado en piezas) + audio</div>

  </div>  <script>
    /* ===== Config ===== */
    const phrase = "Lucas el más lindo"; // texto inicial
    const stage = document.getElementById('stage');
    const gate = document.getElementById('gate');
    const startBtn = document.getElementById('startBtn');
    const left = document.getElementById('leftChar');
    const right = document.getElementById('rightChar');
    const lettersContainer = document.getElementById('lettersContainer');
    const logoGrid = document.getElementById('logoGrid');
    const voice = document.getElementById('voice');

    // Ajusta la densidad de tiles del logo
    const GRID_COLS = 12; // más grande = más piezas
    const GRID_ROWS = 7;
    const LOGO_SRC = 'logo.png'; // reemplaza por tu imagen 3

    function centerOf(el){
      const r = el.getBoundingClientRect();
      return {x: r.left + r.width/2, y: r.top + r.height/2};
    }

    const letters = [];
    const spacing = 54;

    function createLetters(){
      letters.length = 0;
      lettersContainer.innerHTML = '';
      const cx = window.innerWidth/2;
      const cy = window.innerHeight/2 - 40;
      const totalW = (phrase.length - 1) * spacing;
      const startX = cx - totalW/2;
      for(let i=0;i<phrase.length;i++){
        const ch = phrase[i];
        const el = document.createElement('div');
        el.className = 'letter';
        el.textContent = ch;
        const tx = startX + i*spacing;
        const ty = cy;
        el.dataset.tx = tx; el.dataset.ty = ty;
        el.style.left = tx + 'px';
        el.style.top = ty + 'px';
        lettersContainer.appendChild(el);
        letters.push(el);
      }
    }

    function spawnFlame(fromEl, targetEl, delay=0){
      const start = centerOf(fromEl);
      const tx = parseFloat(targetEl.dataset.tx);
      const ty = parseFloat(targetEl.dataset.ty);

      const flame = document.createElement('div');
      flame.className = 'flame';
      flame.innerHTML = '<div class="core"></div><div class="tail"></div>';
      flame.style.left = start.x + 'px';
      flame.style.top = start.y + 'px';
      stage.appendChild(flame);

      const duration = 900 + Math.random()*300;
      const startTime = performance.now() + delay;
      const dx = tx - start.x;
      const dy = ty - start.y;
      const arcHeight = -130 - Math.random()*40;

      function step(t){
        if(t < startTime){ requestAnimationFrame(step); return; }
        const p = Math.min(1,(t - startTime)/duration);
        const arc = arcHeight * Math.sin(Math.PI * p);
        const curx = start.x + dx * p;
        const cury = start.y + dy * p + arc;
        flame.style.left = curx + 'px';
        flame.style.top = cury + 'px';
        flame.style.transform = `translate(-50%,-50%) rotate(${p*540}deg)`;
        // emit small sparks
        if(Math.random() < 0.25){
          const sp = document.createElement('div');
          sp.className = 'flame';
          sp.innerHTML = '<div class="core"></div>';
          sp.style.left = (curx + (Math.random()*20-10)) + 'px';
          sp.style.top = (cury + (Math.random()*20-10)) + 'px';
          sp.style.opacity = .5;
          stage.appendChild(sp);
          setTimeout(()=>sp.remove(), 250);
        }
        if(p < 1){ requestAnimationFrame(step); }
        else {
          targetEl.classList.add('show');
          flame.style.transition = 'opacity .25s';
          flame.style.opacity = '0';
          setTimeout(()=>flame.remove(), 260);
        }
      }
      requestAnimationFrame(step);
    }

    async function launchSequence(){
      // letters
      createLetters();
      await wait(300);
      for(let i=0;i<letters.length;i++){
        const L = letters[i];
        if(L.textContent === ' '){ await wait(120); continue; }
        const from = (i%2===0) ? left : right;
        spawnFlame(from, L, 0);
        await wait(130);
      }
      await wait(1200);
      fadeLetters();
      await wait(550);
      // logo as tiles
      await showLogoTiles();
      // play voice when the last tiles pop
      try{ voice.currentTime = 0; await voice.play(); }catch(e){ /* ignored if blocked */ }
    }

    function fadeLetters(){
      for(const l of letters){
        l.style.transition = 'opacity .6s, transform .6s';
        l.classList.remove('show');
        l.style.opacity = '0';
        l.style.transform = 'translate(-50%,-50%) scale(.7)';
      }
    }

    function clearTiles(){ logoGrid.innerHTML = ''; logoGrid.style.opacity = 0; }

    async function showLogoTiles(){
      clearTiles();
      // compute grid size based on viewport to keep logo reasonable
      const vw = Math.min(window.innerWidth * 0.84, 780);
      const tileW = Math.floor(vw / GRID_COLS) - 2; // -gap
      const tileH = Math.floor((vw*0.6) / GRID_ROWS) - 2; // heuristic aspect
      logoGrid.style.gridTemplateColumns = `repeat(${GRID_COLS}, ${tileW}px)`;
      logoGrid.style.gridTemplateRows = `repeat(${GRID_ROWS}, ${tileH}px)`;
      logoGrid.style.opacity = 1;

      // create tiles with background-position to show slices of the same image
      for(let r=0;r<GRID_ROWS;r++){
        for(let c=0;c<GRID_COLS;c++){
          const tile = document.createElement('div');
          tile.className = 'tile';
          tile.style.width = tileW + 'px';
          tile.style.height = tileH + 'px';
          tile.style.backgroundImage = `url(${LOGO_SRC})`;
          tile.style.backgroundSize = `${GRID_COLS*100}% ${GRID_ROWS*100}%`;
          tile.style.backgroundPosition = `${(c/(GRID_COLS-1))*100}% ${(r/(GRID_ROWS-1))*100}%`;
          logoGrid.appendChild(tile);
        }
      }

      const tiles = Array.from(logoGrid.children);
      // staggered reveal with flame arrivals from alternating sides
      for(let i=0;i<tiles.length;i++){
        const tile = tiles[i];
        await wait(14 + (i%GRID_COLS===0?60:0));
        // compute a pseudo target point for flame: center of tile
        const rect = tile.getBoundingClientRect();
        const tempTarget = document.createElement('div');
        tempTarget.className = 'letter';
        tempTarget.dataset.tx = rect.left + rect.width/2;
        tempTarget.dataset.ty = rect.top + rect.height/2;
        tempTarget.style.left = tempTarget.dataset.tx + 'px';
        tempTarget.style.top = tempTarget.dataset.ty + 'px';
        tempTarget.textContent = ''; // invisible helper
        lettersContainer.appendChild(tempTarget);
        spawnFlame((i%2===0)?left:right, tempTarget, 0);
        setTimeout(()=>tempTarget.remove(), 400);
        // pop the tile
        setTimeout(()=> tile.classList.add('show'), 90);
      }

      // subtle float after reveal
      logoGrid.animate([
        { transform:'translate(-50%,-50%) scale(1) translateY(-4px)' },
        { transform:'translate(-50%,-50%) scale(1) translateY(4px)' }
      ],{duration:2600,iterations:Infinity,direction:'alternate',easing:'ease-in-out'});
    }

    function wait(ms){ return new Promise(r=>setTimeout(r,ms)); }

    // Start via gate for audio policies
    function start(){ gate.style.display='none'; launchSequence(); }
    startBtn.addEventListener('click', start);

    // Replay on click
    stage.addEventListener('click', (e)=>{
      if(e.target.closest('#startBtn')) return;
      // clear flames
      document.querySelectorAll('.flame').forEach(n=>n.remove());
      // clear letters
      letters.length = 0; lettersContainer.innerHTML = '';
      // clear tiles
      clearTiles();
      // replay
      launchSequence();
    });

    window.addEventListener('resize', ()=>{
      // re-position letters
      letters.forEach((el, i)=>{
        const cx = window.innerWidth/2;
        const totalW = (phrase.length - 1) * spacing;
        const startX = cx - totalW/2;
        const tx = startX + i*spacing;
        const ty = window.innerHeight/2 - 40;
        el.dataset.tx = tx; el.dataset.ty = ty; el.style.left = tx+'px'; el.style.top = ty+'px';
      });
    });
  </script></body>
</html>
